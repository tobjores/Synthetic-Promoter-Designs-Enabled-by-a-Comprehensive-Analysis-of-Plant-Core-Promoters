%\tikzset{external/export next = false}

\newcounter{plotct}


\begin{tikzpicture}	

	%%% plant enhancers
	
	\coordinate (plantEnh) at (0, 0);
	
	\protosymbol{plantEnh}; 
	
	\begin{axis}[
		at = {(plantEnh)},
		xshift = \plotylabelwidth,
		anchor = north west,
		width = \threecolumnwidth - \plotylabelwidth,
		boxplot/draw direction = y,
		x grids = false,
		ylabel = log\textsubscript{2}(enrichment),
		xlabel = enhancer,
		xtick = {1, 2, 3, 4, 5},
		xticklabels = {none, 35S, \textit{AB80}, \textit{Cab-1}, \textit{rbcS-E9}},
		ytick = {-5, ..., 5},
		ymin = -2.5,
		typeset ticklabels with strut,
		zero line
	]
		
		\foreach \sample [count = \x, evaluate = \x as \col using 100 - (50 * (1 - (\x - 1) / (5 - 1)))] in {none, 35S, AB80, Cab-1, rbcS-E9} {
		
			\edef\thisplot{			
				\noexpand\addplot[boxplot, box color = protoCol, fill = boxcol!\col!boxshade, mark options = {fill = none}, fill opacity = 0.5, draw opacity = 0.67, boxstyle] table[y = \sample] {../data/misc/data_plant_enhancers_protoplasts.tsv};
			}
			\thisplot
				
			\addplot[black, only marks, mark = solido] table[x expr = \x + rand * .3, y = \sample] {../data/misc/data_plant_enhancers_protoplasts.tsv};
		}
		
		\samplesize{../data/misc/sample_size_plant_enhancers_protoplasts.tsv}{id}{n}
		
	\end{axis}
	
\end{tikzpicture}