%\tikzset{external/export next = false}

\begin{tikzpicture}

	%%% enh-effect by TCP (tobacco)
	\coordinate (enhTCPLeaf) at (0, 0);
	
	\leafsymbol{enhTCPLeaf}; 
	
	\begin{hgroupplot}[%
		ylabel = $\log_2$(enhancer responsiveness),
		ymin = -5,
		ymax = 11,
		ytick = {-10, -8, ..., 10},
		group position = {anchor = above north west, at = {(enhTCPLeaf)}, xshift = \plotylabelwidth, yshift = -1.25\baselineskip},
		group/every plot/.append style = {x grids = false},
		zero line,
	]{\twocolumnwidth}{3}{GC content}
	
			
		\nextgroupplot[
			title = Arabidopsis,
			x tick table half = {rawData/enh-effect_TCP_At_leaf_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = arabidopsis]{rawData/enh-effect_TCP_At_leaf_boxplot.tsv}{rawData/enh-effect_TCP_At_leaf_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = arabidopsis]{rawData/enh-effect_TCP_At_leaf_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_TCP_At_leaf_pvalues.tsv}	
		
		
		\nextgroupplot[
			title = Maize,
			x tick table half = {rawData/enh-effect_TCP_Zm_leaf_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = maize]{rawData/enh-effect_TCP_Zm_leaf_boxplot.tsv}{rawData/enh-effect_TCP_Zm_leaf_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = maize]{rawData/enh-effect_TCP_Zm_leaf_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_TCP_Zm_leaf_pvalues.tsv}
		
		
		\nextgroupplot[
			title = Sorghum,
			x tick table half = {rawData/enh-effect_TCP_Sb_leaf_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = sorghum]{rawData/enh-effect_TCP_Sb_leaf_boxplot.tsv}{rawData/enh-effect_TCP_Sb_leaf_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = sorghum]{rawData/enh-effect_TCP_Sb_leaf_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_TCP_Sb_leaf_pvalues.tsv}	

	\end{hgroupplot}
	
	\node[anchor = south west] (legend) at (group c1r1.above north west) {\textbf{TCP} transcripition factor binding site: $-$};
	\coordinate (legend symbol) at ($(legend.south east) + (.25em, .2em)$);
	\node[anchor = base west] at ($(legend.base east) + (.6em, 0)$) {$+$};
	
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolleft, fill opacity = .5, x = .25em, y = .1em, rotate = 90, shift = {(legend symbol)}] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolright, fill opacity = .5, x = .25em, y = -.1em, rotate = 90, shift = {(legend symbol)}, yshift = -.1em] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	
	
	%%% enh-effect by TCP (protoplasts)
	\coordinate (enhTCPProto) at (\textwidth - \twocolumnwidth, 0 |- enhTCPLeaf);
	
	\protosymbol{enhTCPProto}; 
	
	\begin{hgroupplot}[%
		ylabel = $\log_2$(enhancer responsiveness),
		ymin = -5,
		ymax = 11,
		ytick = {-10, -8, ..., 10},
		group position = {anchor = above north west, at = {(enhTCPProto)}, xshift = \plotylabelwidth, yshift = -1.25\baselineskip},
		group/every plot/.append style = {x grids = false},
		zero line,
	]{\twocolumnwidth}{3}{GC content}
	
			
		\nextgroupplot[
			title = Arabidopsis,
			x tick table half = {rawData/enh-effect_TCP_At_proto_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = arabidopsis]{rawData/enh-effect_TCP_At_proto_boxplot.tsv}{rawData/enh-effect_TCP_At_proto_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = arabidopsis]{rawData/enh-effect_TCP_At_proto_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_TCP_At_proto_pvalues.tsv}	
		
		
		\nextgroupplot[
			title = Maize,
			x tick table half = {rawData/enh-effect_TCP_Zm_proto_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = maize]{rawData/enh-effect_TCP_Zm_proto_boxplot.tsv}{rawData/enh-effect_TCP_Zm_proto_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = maize]{rawData/enh-effect_TCP_Zm_proto_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_TCP_Zm_proto_pvalues.tsv}
		
		
		\nextgroupplot[
			title = Sorghum,
			x tick table half = {rawData/enh-effect_TCP_Sb_proto_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = sorghum]{rawData/enh-effect_TCP_Sb_proto_boxplot.tsv}{rawData/enh-effect_TCP_Sb_proto_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = sorghum]{rawData/enh-effect_TCP_Sb_proto_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_TCP_Sb_proto_pvalues.tsv}	

	\end{hgroupplot}
	
	\node[anchor = south west] (legend) at (group c1r1.above north west) {\textbf{TCP} transcripition factor binding site: $-$};
	\coordinate (legend symbol) at ($(legend.south east) + (.25em, .2em)$);
	\node[anchor = base west] at ($(legend.base east) + (.6em, 0)$) {$+$};
	
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolleft, fill opacity = .5, x = .25em, y = .1em, rotate = 90, shift = {(legend symbol)}] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolright, fill opacity = .5, x = .25em, y = -.1em, rotate = 90, shift = {(legend symbol)}, yshift = -.1em] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	

	%%% enh-effect by WRKY (tobacco)
	\coordinate[yshift = -\columnsep] (enhWRKYLeaf) at (enhTCPLeaf |- plot xlabel.south);
	
	\leafsymbol{enhWRKYLeaf}; 
	
	\begin{hgroupplot}[%
		ylabel = $\log_2$(enhancer responsiveness),
		ymin = -5,
		ymax = 11,
		ytick = {-10, -8, ..., 10},
		group position = {anchor = above north west, at = {(enhWRKYLeaf)}, xshift = \plotylabelwidth, yshift = -1.25\baselineskip},
		group/every plot/.append style = {x grids = false},
		zero line,
	]{\twocolumnwidth}{3}{GC content}
	
			
		\nextgroupplot[
			title = Arabidopsis,
			x tick table half = {rawData/enh-effect_WRKY_At_leaf_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = arabidopsis]{rawData/enh-effect_WRKY_At_leaf_boxplot.tsv}{rawData/enh-effect_WRKY_At_leaf_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = arabidopsis]{rawData/enh-effect_WRKY_At_leaf_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_WRKY_At_leaf_pvalues.tsv}	
		
		
		\nextgroupplot[
			title = Maize,
			x tick table half = {rawData/enh-effect_WRKY_Zm_leaf_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = maize]{rawData/enh-effect_WRKY_Zm_leaf_boxplot.tsv}{rawData/enh-effect_WRKY_Zm_leaf_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = maize]{rawData/enh-effect_WRKY_Zm_leaf_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_WRKY_Zm_leaf_pvalues.tsv}
		
		
		\nextgroupplot[
			title = Sorghum,
			x tick table half = {rawData/enh-effect_WRKY_Sb_leaf_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = sorghum]{rawData/enh-effect_WRKY_Sb_leaf_boxplot.tsv}{rawData/enh-effect_WRKY_Sb_leaf_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = sorghum]{rawData/enh-effect_WRKY_Sb_leaf_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_WRKY_Sb_leaf_pvalues.tsv}	

	\end{hgroupplot}
	
	\node[anchor = south west] (legend) at (group c1r1.above north west) {\textbf{WRKY/C3H} transcripition factor binding site: $-$};
	\coordinate (legend symbol) at ($(legend.south east) + (.25em, .2em)$);
	\node[anchor = base west] at ($(legend.base east) + (.6em, 0)$) {$+$};
	
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolleft, fill opacity = .5, x = .25em, y = .1em, rotate = 90, shift = {(legend symbol)}] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolright, fill opacity = .5, x = .25em, y = -.1em, rotate = 90, shift = {(legend symbol)}, yshift = -.1em] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	
	
	%%% enh-effect by WRKY binding site (protoplasts)
	\coordinate (enhWRKYProto) at (\textwidth - \twocolumnwidth, 0 |- enhWRKYLeaf);
	
	\protosymbol{enhWRKYProto}; 
	
	\begin{hgroupplot}[%
		ylabel = $\log_2$(enhancer responsiveness),
		ymin = -5,
		ymax = 11,
		ytick = {-10, -8, ..., 10},
		group position = {anchor = above north west, at = {(enhWRKYProto)}, xshift = \plotylabelwidth, yshift = -1.25\baselineskip},
		group/every plot/.append style = {x grids = false},
		zero line,
	]{\twocolumnwidth}{3}{GC content}
	
			
		\nextgroupplot[
			title = Arabidopsis,
			x tick table half = {rawData/enh-effect_WRKY_At_proto_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = arabidopsis]{rawData/enh-effect_WRKY_At_proto_boxplot.tsv}{rawData/enh-effect_WRKY_At_proto_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = arabidopsis]{rawData/enh-effect_WRKY_At_proto_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_WRKY_At_proto_pvalues.tsv}	
		
		
		\nextgroupplot[
			title = Maize,
			x tick table half = {rawData/enh-effect_WRKY_Zm_proto_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = maize]{rawData/enh-effect_WRKY_Zm_proto_boxplot.tsv}{rawData/enh-effect_WRKY_Zm_proto_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = maize]{rawData/enh-effect_WRKY_Zm_proto_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_WRKY_Zm_proto_pvalues.tsv}
		
		
		\nextgroupplot[
			title = Sorghum,
			x tick table half = {rawData/enh-effect_WRKY_Sb_proto_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = sorghum]{rawData/enh-effect_WRKY_Sb_proto_boxplot.tsv}{rawData/enh-effect_WRKY_Sb_proto_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = sorghum]{rawData/enh-effect_WRKY_Sb_proto_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_WRKY_Sb_proto_pvalues.tsv}	

	\end{hgroupplot}
	
	\node[anchor = south west] (legend) at (group c1r1.above north west) {\textbf{WRKY/C3H} transcripition factor binding site: $-$};
	\coordinate (legend symbol) at ($(legend.south east) + (.25em, .2em)$);
	\node[anchor = base west] at ($(legend.base east) + (.6em, 0)$) {$+$};
	
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolleft, fill opacity = .5, x = .25em, y = .1em, rotate = 90, shift = {(legend symbol)}] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolright, fill opacity = .5, x = .25em, y = -.1em, rotate = 90, shift = {(legend symbol)}, yshift = -.1em] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;


	%%% enh-effect by B3 binding site (tobacco)
	\coordinate[yshift = -\columnsep] (enhB3Leaf) at (enhTCPLeaf |- plot xlabel.south);
	
	\leafsymbol{enhB3Leaf}; 
	
	\begin{hgroupplot}[%
		ylabel = $\log_2$(enhancer responsiveness),
		ymin = -5,
		ymax = 11,
		ytick = {-10, -8, ..., 10},
		group position = {anchor = above north west, at = {(enhB3Leaf)}, xshift = \plotylabelwidth, yshift = -1.25\baselineskip},
		group/every plot/.append style = {x grids = false},
		zero line,
	]{\twocolumnwidth}{3}{GC content}
	
			
		\nextgroupplot[
			title = Arabidopsis,
			x tick table half = {rawData/enh-effect_B3_At_leaf_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = arabidopsis]{rawData/enh-effect_B3_At_leaf_boxplot.tsv}{rawData/enh-effect_B3_At_leaf_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = arabidopsis]{rawData/enh-effect_B3_At_leaf_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_B3_At_leaf_pvalues.tsv}	
		
		
		\nextgroupplot[
			title = Maize,
			x tick table half = {rawData/enh-effect_B3_Zm_leaf_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = maize]{rawData/enh-effect_B3_Zm_leaf_boxplot.tsv}{rawData/enh-effect_B3_Zm_leaf_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = maize]{rawData/enh-effect_B3_Zm_leaf_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_B3_Zm_leaf_pvalues.tsv}
		
		
		\nextgroupplot[
			title = Sorghum,
			x tick table half = {rawData/enh-effect_B3_Sb_leaf_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = sorghum]{rawData/enh-effect_B3_Sb_leaf_boxplot.tsv}{rawData/enh-effect_B3_Sb_leaf_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = sorghum]{rawData/enh-effect_B3_Sb_leaf_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_B3_Sb_leaf_pvalues.tsv}	

	\end{hgroupplot}
	
	\node[anchor = south west] (legend) at (group c1r1.above north west) {\textbf{B3} transcripition factor binding site: $-$};
	\coordinate (legend symbol) at ($(legend.south east) + (.25em, .2em)$);
	\node[anchor = base west] at ($(legend.base east) + (.6em, 0)$) {$+$};
	
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolleft, fill opacity = .5, x = .25em, y = .1em, rotate = 90, shift = {(legend symbol)}] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolright, fill opacity = .5, x = .25em, y = -.1em, rotate = 90, shift = {(legend symbol)}, yshift = -.1em] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	
	
	%%% enh-effect by B3 binding site (protoplasts)
	\coordinate (enhB3Proto) at (\textwidth - \twocolumnwidth, 0 |- enhB3Leaf);
	
	\protosymbol{enhB3Proto}; 
	
	\begin{hgroupplot}[%
		ylabel = $\log_2$(enhancer responsiveness),
		ymin = -5,
		ymax = 11,
		ytick = {-10, -8, ..., 10},
		group position = {anchor = above north west, at = {(enhB3Proto)}, xshift = \plotylabelwidth, yshift = -1.25\baselineskip},
		group/every plot/.append style = {x grids = false},
		zero line,
	]{\twocolumnwidth}{3}{GC content}
	
			
		\nextgroupplot[
			title = Arabidopsis,
			x tick table half = {rawData/enh-effect_B3_At_proto_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = arabidopsis]{rawData/enh-effect_B3_At_proto_boxplot.tsv}{rawData/enh-effect_B3_At_proto_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = arabidopsis]{rawData/enh-effect_B3_At_proto_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_B3_At_proto_pvalues.tsv}	
		
		
		\nextgroupplot[
			title = Maize,
			x tick table half = {rawData/enh-effect_B3_Zm_proto_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = maize]{rawData/enh-effect_B3_Zm_proto_boxplot.tsv}{rawData/enh-effect_B3_Zm_proto_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = maize]{rawData/enh-effect_B3_Zm_proto_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_B3_Zm_proto_pvalues.tsv}
		
		
		\nextgroupplot[
			title = Sorghum,
			x tick table half = {rawData/enh-effect_B3_Sb_proto_boxplot.tsv}{LaTeX.label}
		]
			
		% half violin and box plot
		\halfviolinbox[violin color half = sorghum]{rawData/enh-effect_B3_Sb_proto_boxplot.tsv}{rawData/enh-effect_B3_Sb_proto_violin.tsv}
			
		% add sample size
		\samplesizehalf[violin color half = sorghum]{rawData/enh-effect_B3_Sb_proto_boxplot.tsv}{id}{n}
		
		% add pvalues
		\signifall*{rawData/enh-effect_B3_Sb_proto_pvalues.tsv}	

	\end{hgroupplot}
	
	\node[anchor = south west] (legend) at (group c1r1.above north west) {\textbf{B3} transcripition factor binding site: $-$};
	\coordinate (legend symbol) at ($(legend.south east) + (.25em, .2em)$);
	\node[anchor = base west] at ($(legend.base east) + (.6em, 0)$) {$+$};
	
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolleft, fill opacity = .5, x = .25em, y = .1em, rotate = 90, shift = {(legend symbol)}] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	\fill[thin, draw = black, /pgfplots/violin color half = arabidopsis, fill = viocolright, fill opacity = .5, x = .25em, y = -.1em, rotate = 90, shift = {(legend symbol)}, yshift = -.1em] plot[domain = 0:6] (\x,{4*1/exp(((\x-3)^2)/2)}) -- cycle;
	
	
	%%% subfigure labels
	\subfiglabel[yshift = .5\columnsep]{enhTCPLeaf}
	\subfiglabel[yshift = .5\columnsep]{enhTCPProto}
	\subfiglabel[yshift = .5\columnsep]{enhWRKYLeaf}
	\subfiglabel[yshift = .5\columnsep]{enhWRKYProto}
	\subfiglabel[yshift = .5\columnsep]{enhB3Leaf}
	\subfiglabel[yshift = .5\columnsep]{enhB3Proto}

\end{tikzpicture}